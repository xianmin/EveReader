(function(t){function e(e){for(var r,o,s=e[0],u=e[1],c=e[2],l=0,d=[];l<s.length;l++)o=s[l],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&d.push(i[o][0]),i[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(t[r]=u[r]);f&&f(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,o=1;o<n.length;o++){var s=n[o];0!==i[s]&&(r=!1)}r&&(a.splice(e--,1),t=u(u.s=n[0]))}return t}var r={},o={app:0},i={app:0},a=[];function s(t){return u.p+"static/js/"+({about:"about"}[t]||t)+"."+{about:"6c569470","chunk-cc5fc838":"c7dfbc6f"}[t]+".js"}function u(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(t){var e=[],n={"chunk-cc5fc838":1};o[t]?e.push(o[t]):0!==o[t]&&n[t]&&e.push(o[t]=new Promise((function(e,n){for(var r="static/css/"+({about:"about"}[t]||t)+"."+{about:"31d6cfe0","chunk-cc5fc838":"975647d3"}[t]+".css",i=u.p+r,a=document.getElementsByTagName("link"),s=0;s<a.length;s++){var c=a[s],l=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(l===r||l===i))return e()}var d=document.getElementsByTagName("style");for(s=0;s<d.length;s++){c=d[s],l=c.getAttribute("data-href");if(l===r||l===i)return e()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=e,f.onerror=function(e){var r=e&&e.target&&e.target.src||i,a=new Error("Loading CSS chunk "+t+" failed.\n("+r+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=r,delete o[t],f.parentNode.removeChild(f),n(a)},f.href=i;var h=document.getElementsByTagName("head")[0];h.appendChild(f)})).then((function(){o[t]=0})));var r=i[t];if(0!==r)if(r)e.push(r[2]);else{var a=new Promise((function(e,n){r=i[t]=[e,n]}));e.push(r[2]=a);var c,l=document.createElement("script");l.charset="utf-8",l.timeout=120,u.nc&&l.setAttribute("nonce",u.nc),l.src=s(t);var d=new Error;c=function(e){l.onerror=l.onload=null,clearTimeout(f);var n=i[t];if(0!==n){if(n){var r=e&&("load"===e.type?"missing":e.type),o=e&&e.target&&e.target.src;d.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",d.name="ChunkLoadError",d.type=r,d.request=o,n[1](d)}i[t]=void 0}};var f=setTimeout((function(){c({type:"timeout",target:l})}),12e4);l.onerror=l.onload=c,document.head.appendChild(l)}return Promise.all(e)},u.m=t,u.c=r,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/EveReader/",u.oe=function(t){throw console.error(t),t};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],l=c.push.bind(c);c.push=e,c=c.slice();for(var d=0;d<c.length;d++)e(c[d]);var f=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"2aa2":function(t,e,n){"use strict";n("d3b7"),n("25f0"),n("498a");var r=n("d4ec"),o=n("bee2"),i=n("7837"),a=n("ab8c"),s=function(){function t(e,n,o,i){Object(r["a"])(this,t),this.layout=e,this.horizontal="horizontal"===o,this.direction=n||"ltr",this._dev=i}return Object(o["a"])(t,[{key:"section",value:function(t){var e=this.findRanges(t),n=this.rangeListToCfiList(t.section.cfiBase,e);return n}},{key:"page",value:function(t,e,n,r){var o,a=t;if(a){if(o=this.rangePairToCfiPair(e,{start:this.findStart(a,n,r),end:this.findEnd(a,n,r)}),!0===this._dev){var s=t.document,u=new i["a"](o.start).toRange(s),c=new i["a"](o.end).toRange(s),l=s.defaultView.getSelection(),d=s.createRange();l.removeAllRanges(),d.setStart(u.startContainer,u.startOffset),d.setEnd(c.endContainer,c.endOffset),l.addRange(d)}return o}}},{key:"walk",value:function(t,e){var n={acceptNode:function(t){return t.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},r=n.acceptNode;r.acceptNode=n.acceptNode;var o,i,a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,r,!1);while(o=a.nextNode())if(i=e(o),i)break;return i}},{key:"findRanges",value:function(t){for(var e,n,r=[],o=t.contents.scrollWidth(),i=Math.ceil(o/this.layout.spreadWidth),a=i*this.layout.divisor,s=this.layout.columnWidth,u=this.layout.gap,c=0;c<a.pages;c++)e=(s+u)*c,n=s*(c+1)+u*c,r.push({start:this.findStart(t.document.body,e,n),end:this.findEnd(t.document.body,e,n)});return r}},{key:"findStart",value:function(t,e,n){var r,o,i=this,s=[t],u=t;while(s.length)if(r=s.shift(),o=this.walk(r,(function(t){var r,o,c,l,d;if(d=Object(a["s"])(t),i.horizontal&&"ltr"===i.direction){if(r=i.horizontal?d.left:d.top,o=i.horizontal?d.right:d.bottom,r>=e&&r<=n)return t;if(o>e)return t;u=t,s.push(t)}else if(i.horizontal&&"rtl"===i.direction){if(r=d.left,o=d.right,o<=n&&o>=e)return t;if(r<n)return t;u=t,s.push(t)}else{if(c=d.top,l=d.bottom,c>e&&c<n)return t;if(l>e)return t;u=t,s.push(t)}})),o)return this.findTextStartRange(o,e,n);return this.findTextStartRange(u,e,n)}},{key:"findEnd",value:function(t,e,n){var r,o,i=this,s=[t],u=t;while(s.length)if(r=s.shift(),o=this.walk(r,(function(t){var r,o,c,l,d;if(d=Object(a["s"])(t),i.horizontal&&"ltr"===i.direction){if(r=Math.round(d.left),o=Math.round(d.right),r>n&&u)return u;if(o>n)return t;u=t,s.push(t)}else if(i.horizontal&&"rtl"===i.direction){if(r=Math.round(i.horizontal?d.left:d.top),o=Math.round(i.horizontal?d.right:d.bottom),o<e&&u)return u;if(r<e)return t;u=t,s.push(t)}else{if(c=Math.round(d.top),l=Math.round(d.bottom),c>n&&u)return u;if(l>n)return t;u=t,s.push(t)}})),o)return this.findTextEndRange(o,e,n);return this.findTextEndRange(u,e,n)}},{key:"findTextStartRange",value:function(t,e,n){for(var r,o,i,a,s,u=this.splitTextNodeIntoRanges(t),c=0;c<u.length;c++)if(r=u[c],o=r.getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(i=o.left,i>=e)return r}else if(this.horizontal&&"rtl"===this.direction){if(s=o.right,s<=n)return r}else if(a=o.top,a>e)return r;return u[0]}},{key:"findTextEndRange",value:function(t,e,n){for(var r,o,i,a,s,u,c,l=this.splitTextNodeIntoRanges(t),d=0;d<l.length;d++){if(o=l[d],i=o.getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(a=i.left,s=i.right,a>n&&r)return r;if(s>n)return o}else if(this.horizontal&&"rtl"===this.direction){if(a=i.left,s=i.right,s<e&&r)return r;if(a<e)return o}else{if(u=i.top,c=i.bottom,u>n&&r)return r;if(c>n)return o}r=o}return l[l.length-1]}},{key:"splitTextNodeIntoRanges",value:function(t,e){for(var n,r=[],o=t.textContent||"",i=o.trim(),a=t.ownerDocument,s=0;s<i.length;s++)n=a.createRange(),n.setStart(t,s),n.setEnd(t,s+1),r.push(n),n=!1;return r}},{key:"rangePairToCfiPair",value:function(t,e){var n=e.start,r=e.end;n.collapse(!0),r.collapse(!1);var o=new i["a"](n,t).toString(),a=new i["a"](r,t).toString();return{start:o,end:a}}},{key:"rangeListToCfiList",value:function(t,e){for(var n,r=[],o=0;o<e.length;o++)n=this.rangePairToCfiPair(t,e[o]),r.push(n);return r}},{key:"axis",value:function(t){return t&&(this.horizontal="horizontal"===t),this.horizontal}}]),t}();e["a"]=s},"2d3f":function(t,e,n){},"3b1d":function(t,e,n){},"4a0c":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{"background-color":this.backgroundColor},attrs:{id:"eve-reader-view"}},[n("div",{ref:"viewSection",style:{fontSize:this.fontSize+"px","line-height":this.lineHeight,"max-width":this.pageWidth+"px"},attrs:{id:"viewSection"},domProps:{innerHTML:t._s(t.sectionContent)}}),t.ebookViewReady?n("eve-annotator"):t._e(),t.ebookViewReady?n("eve-annotation-list"):t._e(),n("loading-ring",{directives:[{name:"show",rawName:"v-show",value:null!==t.loadingTimeOut,expression:"loadingTimeOut !== null"}],staticClass:"loading-ring",attrs:{radius:"30",progress:t.loadingTimer,stroke:"5"}})],1)},o=[],i=(n("c975"),n("ac1f"),n("5319"),n("96cf"),n("1da1")),a=n("5530"),s=n("2f62"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("eve-annotator-popover",{directives:[{name:"show",rawName:"v-show",value:t.showAnnotator,expression:"showAnnotator"}],attrs:{showAnnotatorFromClick:t.showAnnotatorFromClick,annotatorPosition:t.annotator.position},on:{"do-annotator-highlight":t.doAnnotatorHighlight,"do-annotator-delete":t.doAnnotatorDelete,"do-annotator-copy":t.doAnnotatorCopy,"do-annotator-note":t.doAnnotatorNote}})},c=[],l=(n("d3b7"),n("25f0"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:{position:"fixed",top:+t.annotatorPosition.top+"px",left:+t.annotatorPosition.left+"px"},attrs:{id:"eve-popover-wrapper"}},[n("div",{staticClass:"eve-popover-circle-list"},t._l(t.annotatorColorList,(function(e,r){return n("div",{key:e,staticClass:"eve-popover-circle",class:"eve-hl-"+r,style:{background:e},on:{click:function(n){return t.$emit("do-annotator-highlight",e)}}})})),0),n("div",{staticClass:"eve-popover-tool-list"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showAnnotatorFromClick,expression:"showAnnotatorFromClick"}],staticClass:"eve-popover-tool tool-delete",on:{click:function(e){return t.$emit("do-annotator-delete")}}},[n("i",{staticClass:"el-icon-delete"})]),n("div",{staticClass:"eve-popover-tool tool-note",on:{click:function(e){return t.$emit("do-annotator-note")}}},[t._v(" Note ")]),n("div",{staticClass:"eve-popover-tool tool-copy",on:{click:function(e){return t.$emit("do-annotator-copy")}}},[t._v(" Copy ")])])])}),d=[],f={computed:Object(a["a"])({},Object(s["b"])("setting",["annotatorColorList"])),props:["showAnnotatorFromClick","annotatorPosition"],mounted:function(){},methods:{}},h=f,p=(n("e950"),n("2877")),g=Object(p["a"])(h,l,d,!1,null,"22fc5670",null),m=g.exports,v=n("7837"),b={components:{EveAnnotatorPopover:m},data:function(){return{viewSectionElement:null,showAnnotator:!1,showAnnotatorFromClick:!1,annotator:{position:{top:0,left:0},cfiRange:"",text:""},selectRange:null}},mounted:function(){this.viewSectionElement=this.$parent.$refs.viewSection,this.viewSectionElement.addEventListener("mouseup",this._onMouseUp.bind(this)),this.viewSectionElement.addEventListener("mousedown",this._onMouseDown.bind(this)),this.$bus.on("click-show-annotator",this.onClickShowAnnotator)},beforeDestroy:function(){this.viewSectionElement.removeEventListener("mouseup",this._onMouseUp.bind(this)),this.viewSectionElement.removeEventListener("mousedown",this._onMouseDown.bind(this)),this.$bus.off("click-show-annotator")},methods:{_onMouseUp:function(t){t.preventDefault();var e=window.getSelection();if(!e.isCollapsed){this.selectRange=e.getRangeAt(0);var n=this.selectRange.getBoundingClientRect();this.setAnnotatorPosition(n,t.clientX,t.clientY),this.annotator.cfiRange=new v["a"](this.selectRange,this.$parent.section.cfiBase).toString(),this.showAnnotator=!0,this.showAnnotatorFromClick=!1,this.annotator.text=e.toString()}},_onMouseDown:function(){this.showAnnotator=!1,window.getSelection().removeAllRanges()},setAnnotatorPosition:function(t,e,n){var r=t.bottom+5,o=e-65;o<0&&(o=e),o+130>window.innerWidth&&(o=window.innerWidth-140);var i=function(){return t.bottom-n>n-t.top+20},a=function(){return t.top>65},s=function(){return window.innerHeight-t.bottom>65};i()?a()?r=t.top-65:s()||(r=n+5):s()||(r=a()?t.top-65:n-65),this.annotator.position.top=r,this.annotator.position.left=o},onClickShowAnnotator:function(t,e){this.showAnnotatorFromClick=!0,this.annotator.cfiRange=e.cfiRange,this.annotator.type=e.type,this.annotator.text=e.text;var n=new v["a"](this.annotator.cfiRange);this.selectRange=n.toRange(this.$store.state.ebookRootNode);var r=this.selectRange.getBoundingClientRect();this.setAnnotatorPosition(r,t.clientX,t.clientY),this.showAnnotator=!0},doAnnotatorHighlight:function(t){this.showAnnotatorFromClick&&this.doAnnotatorDelete();var e={type:"highlight"};e.cfiRange=this.annotator.cfiRange,e.color=t,e.hash=encodeURI("highlight-"+e.cfiRange),e.text=this.annotator.text,e.sectionIndex=this.$parent.section.index,e.date=(new Date).toISOString(),this.showAnnotator=!1,this.$store.dispatch("annotation/addAnnotation",e)},doAnnotatorDelete:function(){this.showAnnotator=!1,this.showAnnotatorFromClick=!1;var t=this.annotator.cfiRange,e=this.annotator.type,n=encodeURI(e+"-"+t);this.$store.dispatch("annotation/deleteAnnotation",n)},doAnnotatorCopy:function(){navigator.clipboard.writeText(this.annotator.text),this.showAnnotator=!1},doAnnotatorNote:function(){this.showAnnotator=!1}}},w=b,y=Object(p["a"])(w,u,c,!1,null,null,null),x=y.exports,k=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"eve-annotation-list"}},t._l(t.getBySectionIndex,(function(t){return n("eve-annotation-svg",{key:t.hash,attrs:{annotation:t}})})),1)},O=[],R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{staticStyle:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},attrs:{"pointer-events":"none"}},[n("g",{ref:"annotation",attrs:{fill:this.annotation.color,"fill-opacity":"0.3","pointer-events":"visiblePainted"},on:{click:t.clickAnnotation}},t._l(t.rects,(function(t,e){return n("rect",{key:e,attrs:{x:t.left,y:t.top,height:t.height,width:t.width}})})),0)])},T=[],E=(n("4160"),n("a630"),n("3ca3"),n("159b"),{props:["annotation"],data:function(){return{rects:[]}},mounted:function(){var t=this,e=new v["a"](this.annotation.cfiRange),n=e.toRange(this.$store.state.ebookRootNode),r=Array.from(n.getClientRects());r.forEach((function(e){e.y+=window.scrollY,e.x-=t.$parent.$el.getBoundingClientRect().left})),this.rects=r},methods:{clickAnnotation:function(t){this.$bus.emit("click-show-annotator",t,this.annotation)}}}),S=E,N=(n("5e47"),Object(p["a"])(S,R,T,!1,null,null,null)),C=N.exports,A={components:{EveAnnotationSvg:C},computed:Object(a["a"])({},Object(s["b"])("annotation",["getBySectionIndex"])),mounted:function(){}},_=A,j=Object(p["a"])(_,k,O,!1,null,null,null),D=j.exports,L=n("2aa2"),I=n("ab8c"),B=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{height:2*t.radius,width:2*t.radius}},[n("circle",{style:{strokeDashoffset:t.strokeDashoffset},attrs:{stroke:"#409eff",fill:"transparent","stroke-dasharray":t.circumference+" "+t.circumference,"stroke-width":t.stroke,r:t.normalizedRadius,cx:t.radius,cy:t.radius}})])},P=[],$={props:["radius","progress","stroke"],data:function(){var t=this.radius-2*this.stroke,e=2*t*Math.PI;return{normalizedRadius:t,circumference:e}},computed:{strokeDashoffset:function(){return this.circumference-this.progress/100*this.circumference}}},F=$,W=Object(p["a"])(F,B,P,!1,null,null,null),z=W.exports,M={computed:Object(a["a"])(Object(a["a"])({},Object(s["b"])(["ebook","ebookViewReady"])),Object(s["b"])("setting",["fontSize","lineHeight","pageWidth","backgroundColor"])),components:{EveAnnotator:x,EveAnnotationList:D,LoadingRing:z},data:function(){return{spineItems:null,section:null,sectionContent:null,scrollTimeOut:null,loadingTimer:0,loadingTimeOut:null}},mounted:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.ebook.loaded();case 2:return e.next=4,t.$store.dispatch("annotation/initAnnotation");case 4:return e.next=6,t.$store.dispatch("getLastCFI");case 6:n=e.sent,t.spineItems=t.ebook.epub.spine.spineItems,t.display(n||0),t.$bus.on("event-view-display",t.display),window.addEventListener("keydown",t.eventKeyDown),window.addEventListener("wheel",t.eventWheel),window.addEventListener("scroll",t.eventScroll);case 13:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){this.$bus.off("event-view-display"),window.removeEventListener("keydown",this.eventKeyDown),window.removeEventListener("wheel",this.eventWheel),window.removeEventListener("scroll",this.eventScroll),this.$store.commit("SET_EBOOK_VIEW_READY",!1)},watch:{},methods:{display:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.$store.commit("SET_EBOOK_VIEW_READY",!1),r=e.ebook.epub.spine.get(t),r.index!==e.$store.state.currentSectionIndex){n.next=6;break}return n.next=5,e.moveToTarget(t);case 5:return n.abrupt("return");case 6:return e.$store.commit("SET_CURRENT_SECTION_INDEX",r.index),e.section=r,o=e.ebook.epub.load.bind(e.ebook.epub),n.next=11,e.section.render(o);case 11:i=n.sent,e.sectionContent=i.replace(/(<\s*\/?\s*)html(\s*([^>]*)?\s*>)/gi,"$1eve-view-html$2").replace(/(<\s*\/?\s*)head(\s*([^>]*)?\s*>)/gi,"$1eve-view-head$2").replace(/(<\s*\/?\s*)body(\s*([^>]*)?\s*>)/gi,"$1eve-view-body$2"),e.$nextTick((function(){e.$store.commit("SET_EBOOK_ROOT_NODE",e.$refs.viewSection.childNodes[0]),e.addLinkEvent(),setTimeout((function(){e.$store.commit("SET_EBOOK_VIEW_READY",!0),t===e.section.href?window.scroll(0,0):Object(I["p"])(t)||e.moveToTarget(t)}),30)}));case 14:case"end":return n.stop()}}),n)})))()},moveToTarget:function(t){var e=this.locationOf(t);window.scrollY>0?window.scrollTo(0,e.top+window.scrollY):window.scrollTo(0,e.top),this.$store.commit("SET_EBOOK_VIEW_READY",!0)},locationOf:function(t){var e,n={left:0,top:0},r=new v["a"];if(r.isCfiString(t)){var o=new v["a"](t).toRange(this.$store.state.ebookRootNode);o&&(e=o.getBoundingClientRect())}else if("string"===typeof t&&t.indexOf("#")>-1){var i=t.substring(t.indexOf("#")+1),a=document.getElementById(i);a&&(e=a.getBoundingClientRect())}return e&&(n.left=e.left,n.top=e.top),n},currentLocation:function(){var t=new L["a"],e=t.page(this.$refs.viewSection,this.section.cfiBase,0,window.innerHeight);return e},doPrev:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.section.index>0)){e.next=5;break}return e.next=3,t.display(t.section.index-1);case 3:window.scroll(0,document.body.clientHeight),t.storeLocation();case 5:case"end":return e.stop()}}),e)})))()},doNext:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.section.index<t.spineItems.length-1)){e.next=5;break}return e.next=3,t.display(t.section.index+1);case 3:window.scroll(0,0),t.storeLocation();case 5:case"end":return e.stop()}}),e)})))()},storeLocation:function(){var t=this.currentLocation();this.$store.dispatch("setLastRead",t.start)},eventScroll:function(){var t=this;null!==this.scrollTimeOut&&clearTimeout(this.scrollTimeOut),this.scrollTimeOut=setTimeout((function(){t.storeLocation()}),200)},eventKeyDown:function(t){var e=t.keyCode||t.which;0===window.scrollY&&(33!==e&&38!==e||(this.doPrev(),t.preventDefault())),window.scrollY+window.innerHeight>=document.body.clientHeight&&(34!==e&&40!==e||(this.doNext(),t.preventDefault()))},eventWheel:function(t){0===window.scrollY&&t.wheelDelta>0&&(this.loadingTimer+=5,this.loadingTimer>=100&&this.doPrev(),this.loadingStop()),window.scrollY+window.innerHeight>=document.body.clientHeight&&t.wheelDelta<0&&(this.loadingTimer+=5,this.loadingTimer>=100&&this.doNext(),this.loadingStop())},loadingStop:function(){var t=this;null!==this.loadingTimeOut&&clearTimeout(this.loadingTimeOut),this.loadingTimeOut=setTimeout((function(){t.loadingTimer=0}),100)},addLinkEvent:function(){for(var t=this,e=this.$store.state.ebookRootNode.querySelectorAll("a[href]"),n=function(n){var r=e[n];r.onclick=function(e){var n;e.preventDefault();var o=r.getAttribute("href");if(0!==o.indexOf("mailto:"))if(o.indexOf("://")>-1)console.log(o);else{var i=function(e){for(var n in t.ebook.epub.spine.spineByHref)if(n.indexOf(e)>-1)return n};if(o.indexOf("#")>-1){var a=o.substring(o.indexOf("#")),s=o.substring(0,o.indexOf("#"));n=i(s)+a}else n=i(o);n&&t.display(n)}}},r=0;r<e.length;r++)n(r)}}},V=M,H=(n("969c"),Object(p["a"])(V,r,o,!1,null,null,null));e["a"]=H.exports},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},i=[],a=n("2877"),s={},u=Object(a["a"])(s,o,i,!1,null,null,null),c=u.exports,l=(n("d3b7"),n("8c4f")),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"eve-calibre-home"},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.bookList,stripe:"",border:"",fit:"","default-sort":{prop:"last_modified",order:"descending"}}},[n("el-table-column",{attrs:{type:"index",align:"center"}}),n("el-table-column",{attrs:{prop:"title",label:"Title"}}),n("el-table-column",{attrs:{prop:"last_modified",label:"Last modified",sortable:"",align:"center",width:"150%"}}),n("el-table-column",{attrs:{label:"Read",align:"center",width:"120%"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"normal"},on:{click:function(n){return t.doRead(e.row)}}},[t._v("READ")])]}}])})],1)],1)},f=[],h=(n("96cf"),n("1da1")),p={name:"home",components:{},data:function(){return{bookList:[]}},beforeCreate:function(){},created:function(){this.init()},methods:{init:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$api.getBookList();case 2:t.bookList=e.sent;case 3:case"end":return e.stop()}}),e)})))()},doRead:function(t){var e="/reader/view/".concat(t.book_id),n=this.$router.resolve(e);window.open(n.href,"_blank")}},mounted:function(){}},g=p,m=(n("f7e7"),Object(a["a"])(g,d,f,!1,null,"33907d84",null)),v=m.exports,b=n("4a0c");r["default"].use(l["a"]);var w,y,x=[{path:"/",name:"Home",component:v,beforeEnter:function(t,e,n){n("/reader/")}},{path:"/reader/",name:"Reader",component:function(){return n.e("chunk-cc5fc838").then(n.bind(null,"968f"))},children:[{path:"/reader/open/:fileName",name:"open",component:b["a"]},{path:"/reader/view/:book_id",name:"view",component:b["a"]}]},{path:"/about",name:"About",component:function(){return n.e("about").then(n.bind(null,"f820"))}}],k=new l["a"]({routes:x}),O=k,R=n("2f62"),T=n("3f4f"),E=1,S=1,N={getEveReaderDB:function(){return Object(h["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(w){t.next=4;break}return t.next=3,Object(T["a"])("EveReader",E,{upgrade:function(t){t.createObjectStore("setting",{keyPath:"name"});var e=t.createObjectStore("lastRead",{keyPath:"ebookID"});e.createIndex("date","date")}});case 3:w=t.sent;case 4:return t.abrupt("return",w);case 5:case"end":return t.stop()}}),t)})))()},getFromDB:function(t,e){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.getEveReaderDB();case 2:return r.prev=2,r.next=5,w.get(t,e);case 5:return r.abrupt("return",r.sent);case 8:return r.prev=8,r.t0=r["catch"](2),r.abrupt("return");case 11:case"end":return r.stop()}}),r,null,[[2,8]])})))()},setToDB:function(t,e){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,n.getEveReaderDB();case 2:return r.next=4,w.put(t,e);case 4:case"end":return r.stop()}}),r)})))()},getSettingFromDB:function(){var t=this;return Object(h["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getFromDB("setting","user-setting");case 2:return n=e.sent,e.abrupt("return",n?n.value:void 0);case 4:case"end":return e.stop()}}),e)})))()},updateSettingToDB:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.getEveReaderDB();case 2:return n.next=4,w.put("setting",{name:"user-setting",value:t});case 4:case"end":return n.stop()}}),n)})))()},getLastReadFromDB:function(t){return this.getFromDB("lastRead",t)},updateLastReadToDB:function(t){this.setToDB("lastRead",t)},getEveAnnotationDB:function(t){return Object(h["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(T["a"])(t,S,{upgrade:function(t){var e=t.createObjectStore("annotation",{keyPath:"hash"});e.createIndex("date","date")}});case 2:return y=e.sent,e.abrupt("return",y);case 4:case"end":return e.stop()}}),e)})))()},getAllAnnotation:function(t){var e=this;return Object(h["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(y){n.next=3;break}return n.next=3,e.getEveAnnotationDB(t);case 3:return n.prev=3,n.next=6,y.getAll("annotation");case 6:return n.abrupt("return",n.sent);case 9:return n.prev=9,n.t0=n["catch"](3),n.abrupt("return");case 12:case"end":return n.stop()}}),n,null,[[3,9]])})))()},addAnnotationToDB:function(t,e){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(y){r.next=3;break}return r.next=3,n.getEveAnnotationDB(t);case 3:return r.next=5,y.put("annotation",e);case 5:case"end":return r.stop()}}),r)})))()},deleteAnnotationFromDB:function(t,e){var n=this;return Object(h["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(y){r.next=3;break}return r.next=3,n.getEveAnnotationDB(t);case 3:return r.next=5,y.delete("annotation",e);case 5:case"end":return r.stop()}}),r)})))()}},C={namespaced:!0,state:{fontSize:18,lineHeight:1.8,pageWidth:900,backgroundColor:"#FFFFFF",annotatorColorList:["red","orange","yellow","green","blue"],sidebarVisible:"",sidebarWidth:25},getters:{fontSize:function(t){return t.fontSize},lineHeight:function(t){return t.lineHeight},pageWidth:function(t){return t.pageWidth},backgroundColor:function(t){return t.backgroundColor},annotatorColorList:function(t){return t.annotatorColorList},sidebarVisible:function(t){return t.sidebarVisible},sidebarWidth:function(t){return t.sidebarWidth}},mutations:{SET_EBOOK_SETTING:function(t,e){for(var n in e)t[n]=e[n]}},actions:{initSetting:function(t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,e.next=3,N.getSettingFromDB();case 3:o=e.sent,o?n("SET_EBOOK_SETTING",o):N.updateSettingToDB(r);case 5:case"end":return e.stop()}}),e)})))()},setEbookSetting:function(t,e){var n=t.commit,r=t.state,o=t.dispatch;n("SET_EBOOK_SETTING",e),o("refreshEbookViewReady",null,{root:!0}),N.updateSettingToDB(r)}}},A=(n("4de4"),n("c740"),n("a434"),n("3ca3"),n("ddb0"),n("2b3d"),{namespaced:!0,state:{annotationList:[]},getters:{annotationList:function(t){return t.annotationList},getBySectionIndex:function(t,e,n){var r=n.currentSectionIndex;return t.annotationList.filter((function(t){return t.sectionIndex===r}))}},mutations:{SET_ANNOTATION_LIST:function(t,e){t.annotationList=e},ADD_ANNOTATION:function(t,e){t.annotationList.push(e)},DELETE_ANNOTATION:function(t,e){var n=t.annotationList.findIndex((function(t){return t.hash===e}));t.annotationList.splice(n,1)}},actions:{initAnnotation:function(t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,t.state,r=t.rootState,e.next=3,N.getEveAnnotationDB(r.ebook.ebookID);case 3:return e.next=5,N.getAllAnnotation();case 5:o=e.sent,n("SET_ANNOTATION_LIST",o);case 7:case"end":return e.stop()}}),e)})))()},addAnnotation:function(t,e){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,t.state,o=t.rootState,r("ADD_ANNOTATION",e),n.next=4,N.addAnnotationToDB(o.ebook.ebookID,e);case 4:case"end":return n.stop()}}),n)})))()},deleteAnnotation:function(t,e){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,t.state,o=t.rootState,r("DELETE_ANNOTATION",e),n.next=4,N.deleteAnnotationFromDB(o.ebook.ebookID,e);case 4:case"end":return n.stop()}}),n)})))()},importAnnotation:function(t,e){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,i,a,s,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.dispatch,o=t.rootState,i=JSON.parse(e),a=i.ebookID,s=i.annotation,o.ebook.ebookID!==a){n.next=17;break}u=0;case 6:if(!(u<s.length)){n.next=12;break}return n.next=9,N.addAnnotationToDB(a,s[u]);case 9:u++,n.next=6;break;case 12:return n.next=14,r("initAnnotation");case 14:return n.abrupt("return","success");case 17:return n.abrupt("return","error");case 18:case"end":return n.stop()}}),n)})))()},exportAnnotation:function(t){var e=t.state,n=t.rootState,r={};r.title=n.ebook.title,r.annotation=e.annotationList,r.ebookID=n.ebook.ebookID;var o=new Blob([JSON.stringify(r)],{type:"application/json"}),i=URL.createObjectURL(o),a=document.createElement("a");a.href=i,a.download="".concat(r.title," - annotation.json"),document.body.appendChild(a),a.click(),document.body.removeChild(a)}}});r["default"].use(R["a"]);var _=new R["a"].Store({state:{ebook:null,ebookRootNode:null,ebookViewReady:!1,lastCfi:0,currentSectionIndex:null},getters:{ebook:function(t){return t.ebook},ebookRootNode:function(t){return t.ebookRootNode},ebookViewReady:function(t){return t.ebookViewReady},lastCfi:function(t){return t.lastCfi},currentSectionIndex:function(t){return t.currentSectionIndex}},mutations:{SET_EBOOK:function(t,e){t.ebook=e},SET_EBOOK_ROOT_NODE:function(t,e){t.ebookRootNode=e},SET_EBOOK_VIEW_READY:function(t,e){t.ebookViewReady=e},SET_LASTCFI:function(t,e){t.lastCfi=e},SET_CURRENT_SECTION_INDEX:function(t,e){t.currentSectionIndex=e}},actions:{setEbook:function(t,e){var n=t.commit;return n("SET_EBOOK",e)},refreshEbookViewReady:function(t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,n("SET_EBOOK_VIEW_READY",!1);case 3:return e.next=5,n("SET_EBOOK_VIEW_READY",!0);case 5:case"end":return e.stop()}}),e)})))()},getLastCFI:function(t){return Object(h["a"])(regeneratorRuntime.mark((function e(){var n,r,o,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,r=t.state,o=t.dispatch,e.next=3,N.getLastReadFromDB(r.ebook.ebookID);case 3:if(i=e.sent,!i){e.next=9;break}return n("SET_LASTCFI",i.lastCfi),e.abrupt("return",i.lastCfi);case 9:return e.next=11,o("setLastRead",0);case 11:return e.abrupt("return",0);case 12:case"end":return e.stop()}}),e)})))()},setLastRead:function(t,e){return Object(h["a"])(regeneratorRuntime.mark((function n(){var r,o,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=t.commit,o=t.state,r("SET_LASTCFI",e),i={},i.ebookID=o.ebook.ebookID,i.date=(new Date).toISOString(),i.lastCfi=e,n.next=8,N.updateLastReadToDB(i);case 8:case"end":return n.stop()}}),n)})))()}},modules:{setting:C,annotation:A}}),j=n("bc3a"),D=n.n(j),L="http://localhost:5000",I=D.a.create({baseURL:L,timeout:1e3});I.interceptors.response.use((function(t){return 200===t.status?Promise.resolve(t.data):Promise.reject(t)}),(function(t){return Promise.reject(t)}));var B=I,P={getBookList:function(){return B.get("".concat(L,"/api/booklist"))}},$=P,F=n("5c96"),W=n.n(F);n("0fae");function z(t){var e=new t;Object.defineProperties(e,{on:{get:function(){return this.$on.bind(this)}},once:{get:function(){return this.$once.bind(this)}},off:{get:function(){return this.$off.bind(this)}},emit:{get:function(){return this.$emit.bind(this)}}}),Object.defineProperty(t,"bus",{get:function(){return e}}),Object.defineProperty(t.prototype,"$bus",{get:function(){return e}})}var M=z;n("7545"),n("2d3f");r["default"].prototype.$api=$,r["default"].config.productionTip=!1,r["default"].use(W.a),r["default"].use(M),new r["default"]({router:O,store:_,render:function(t){return t(c)}}).$mount("#app")},"5e47":function(t,e,n){"use strict";n("6cd2")},"6cd2":function(t,e,n){},7545:function(t,e,n){},7837:function(t,e,n){"use strict";n("99af"),n("4de4"),n("4160"),n("c975"),n("a15b"),n("d81d"),n("fb6a"),n("d3b7"),n("ac1f"),n("25f0"),n("466d"),n("1276"),n("159b");var r=n("53ca"),o=n("d4ec"),i=n("bee2"),a=n("ab8c"),s=1,u=3,c=function(){function t(e,n,i){var s;if(Object(o["a"])(this,t),this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof t))return new t(e,n,i);if("string"===typeof n?this.base=this.parseComponent(n):"object"===Object(r["a"])(n)&&n.steps&&(this.base=n),s=this.checkType(e),"string"===s)return this.str=e,Object(a["h"])(this,this.parse(e));if("range"===s)return Object(a["h"])(this,this.fromRange(e,this.base,i));if("node"===s)return Object(a["h"])(this,this.fromNode(e,this.base,i));if("EpubCFI"===s&&e.path)return e;if(e)throw new TypeError("not a valid argument for EpubCFI");return this}return Object(i["a"])(t,[{key:"checkType",value:function(e){return this.isCfiString(e)?"string":!e||"object"!==Object(r["a"])(e)||"Range"!==Object(a["C"])(e)&&"undefined"==typeof e.startContainer?e&&"object"===Object(r["a"])(e)&&"undefined"!=typeof e.nodeType?"node":!!(e&&"object"===Object(r["a"])(e)&&e instanceof t)&&"EpubCFI":"range"}},{key:"parse",value:function(t){var e,n,r,o={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!==typeof t?{spinePos:-1}:(0===t.indexOf("epubcfi(")&&")"===t[t.length-1]&&(t=t.slice(8,t.length-1)),e=this.getChapterComponent(t),e?(o.base=this.parseComponent(e),n=this.getPathComponent(t),o.path=this.parseComponent(n),r=this.getRange(t),r&&(o.range=!0,o.start=this.parseComponent(r[0]),o.end=this.parseComponent(r[1])),o.spinePos=o.base.steps[1].index,o):{spinePos:-1})}},{key:"parseComponent",value:function(t){var e,n={steps:[],terminal:{offset:null,assertion:null}},r=t.split(":"),o=r[0].split("/");return r.length>1&&(e=r[1],n.terminal=this.parseTerminal(e)),""===o[0]&&o.shift(),n.steps=o.map(function(t){return this.parseStep(t)}.bind(this)),n}},{key:"parseStep",value:function(t){var e,n,r,o,i;if(o=t.match(/\[(.*)\]/),o&&o[1]&&(i=o[1]),n=parseInt(t),!isNaN(n))return n%2===0?(e="element",r=n/2-1):(e="text",r=(n-1)/2),{type:e,index:r,id:i||null}}},{key:"parseTerminal",value:function(t){var e,n,r=t.match(/\[(.*)\]/);return r&&r[1]?(e=parseInt(t.split("[")[0]),n=r[1]):e=parseInt(t),Object(a["p"])(e)||(e=null),{offset:e,assertion:n}}},{key:"getChapterComponent",value:function(t){var e=t.split("!");return e[0]}},{key:"getPathComponent",value:function(t){var e=t.split("!");if(e[1]){var n=e[1].split(",");return n[0]}}},{key:"getRange",value:function(t){var e=t.split(",");return 3===e.length&&[e[1],e[2]]}},{key:"getCharecterOffsetComponent",value:function(t){var e=t.split(":");return e[1]||""}},{key:"joinSteps",value:function(t){return t?t.map((function(t){var e="";return"element"===t.type&&(e+=2*(t.index+1)),"text"===t.type&&(e+=1+2*t.index),t.id&&(e+="["+t.id+"]"),e})).join("/"):""}},{key:"segmentString",value:function(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&null!=t.terminal.offset&&(e+=":"+t.terminal.offset),t.terminal&&null!=t.terminal.assertion&&(e+="["+t.terminal.assertion+"]"),e}},{key:"toString",value:function(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+=")",t}},{key:"compare",value:function(e,n){var r,o,i,a;if("string"===typeof e&&(e=new t(e)),"string"===typeof n&&(n=new t(n)),e.spinePos>n.spinePos)return 1;if(e.spinePos<n.spinePos)return-1;e.range?(r=e.path.steps.concat(e.start.steps),i=e.start.terminal):(r=e.path.steps,i=e.path.terminal),n.range?(o=n.path.steps.concat(n.start.steps),a=n.start.terminal):(o=n.path.steps,a=n.path.terminal);for(var s=0;s<r.length;s++){if(!r[s])return-1;if(!o[s])return 1;if(r[s].index>o[s].index)return 1;if(r[s].index<o[s].index)return-1}return r.length<o.length?-1:i.offset>a.offset?1:i.offset<a.offset?-1:0}},{key:"step",value:function(t){var e=t.nodeType===u?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}}},{key:"filteredStep",value:function(t,e){var n,r=this.filter(t,e);if(r)return n=r.nodeType===u?"text":"element",{id:r.id,tagName:r.tagName,type:n,index:this.filteredPosition(r,e)}}},{key:"pathTo",value:function(t,e,n){var r,o={steps:[],terminal:{offset:null,assertion:null}},i=t;while(i&&i.parentNode&&"EVE-VIEW-HTML"!=i.tagName)r=n?this.filteredStep(i,n):this.step(i),r&&o.steps.unshift(r),i=i.parentNode;return null!=e&&e>=0&&(o.terminal.offset=e,"text"!=o.steps[o.steps.length-1].type&&o.steps.push({type:"text",index:0})),o}},{key:"equalStep",value:function(t,e){return!(!t||!e)&&(t.index===e.index&&t.id===e.id&&t.type===e.type)}},{key:"fromRange",value:function(t,e,n){var o={range:!1,base:{},path:{},start:null,end:null},i=t.startContainer,a=t.endContainer,s=t.startOffset,u=t.endOffset,c=!1;if(n&&(c=null!=i.ownerDocument.querySelector("."+n)),"string"===typeof e?(o.base=this.parseComponent(e),o.spinePos=o.base.steps[1].index):"object"===Object(r["a"])(e)&&(o.base=e),t.collapsed)c&&(s=this.patchOffset(i,s,n)),o.path=this.pathTo(i,s,n);else{o.range=!0,c&&(s=this.patchOffset(i,s,n)),o.start=this.pathTo(i,s,n),c&&(u=this.patchOffset(a,u,n)),o.end=this.pathTo(a,u,n),o.path={steps:[],terminal:null};var l,d=o.start.steps.length;for(l=0;l<d;l++){if(!this.equalStep(o.start.steps[l],o.end.steps[l]))break;l===d-1?o.start.terminal===o.end.terminal&&(o.path.steps.push(o.start.steps[l]),o.range=!1):o.path.steps.push(o.start.steps[l])}o.start.steps=o.start.steps.slice(o.path.steps.length),o.end.steps=o.end.steps.slice(o.path.steps.length)}return o}},{key:"fromNode",value:function(t,e,n){var o={range:!1,base:{},path:{},start:null,end:null};return"string"===typeof e?(o.base=this.parseComponent(e),o.spinePos=o.base.steps[1].index):"object"===Object(r["a"])(e)&&(o.base=e),o.path=this.pathTo(t,null,n),o}},{key:"filter",value:function(t,e){var n,r,o,i,a,s=!1;return t.nodeType===u?(s=!0,o=t.parentNode,n=t.parentNode.classList.contains(e)):(s=!1,n=t.classList.contains(e)),n&&s?(i=o.previousSibling,a=o.nextSibling,i&&i.nodeType===u?r=i:a&&a.nodeType===u&&(r=a),r||t):!(n&&!s)&&t}},{key:"patchOffset",value:function(t,e,n){if(t.nodeType!=u)throw new Error("Anchor must be a text node");var r=t,o=e;t.parentNode.classList.contains(n)&&(r=t.parentNode);while(r.previousSibling){if(r.previousSibling.nodeType===s){if(!r.previousSibling.classList.contains(n))break;o+=r.previousSibling.textContent.length}else o+=r.previousSibling.textContent.length;r=r.previousSibling}return o}},{key:"normalizedMap",value:function(t,e,n){var r,o,i,a={},c=-1,l=t.length;for(r=0;r<l;r++)o=t[r].nodeType,o===s&&t[r].classList.contains(n)&&(o=u),r>0&&o===u&&i===u?a[r]=c:e===o&&(c+=1,a[r]=c),i=o;return a}},{key:"position",value:function(t){var e,n;return t.nodeType===s?(e=t.parentNode.children,e||(e=Object(a["j"])(t.parentNode)),n=Array.prototype.indexOf.call(e,t)):(e=this.textNodes(t.parentNode),n=e.indexOf(t)),n}},{key:"filteredPosition",value:function(t,e){var n,r,o;return t.nodeType===s?(n=t.parentNode.children,o=this.normalizedMap(n,s,e)):(n=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(t=t.parentNode,n=t.parentNode.childNodes),o=this.normalizedMap(n,u,e)),r=Array.prototype.indexOf.call(n,t),o[r]}},{key:"stepsToXpath",value:function(t){var e=[".","*"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("*[position()="+n+" and @id='"+t.id+"']"):"text"===t.type?e.push("text()["+n+"]"):e.push("*["+n+"]")})),e.join("/")}},{key:"stepsToQuerySelector",value:function(t){var e=["html"];return t.forEach((function(t){var n=t.index+1;t.id?e.push("#"+t.id):"text"===t.type||e.push("*:nth-child("+n+")")})),e.join(">")}},{key:"textNodes",value:function(t,e){return Array.prototype.slice.call(t.childNodes).filter((function(t){return t.nodeType===u||!(!e||!t.classList.contains(e))}))}},{key:"walkToNode",value:function(t,e,n){var r,o,i,s=document,u=e,c=t.length;for(i=0;i<c;i++)if(o=t[i],"element"===o.type?o.id?u=s.getElementById(o.id):(r=Object(a["j"])(u),u=r[o.index]):"text"===o.type&&(u=this.textNodes(u,n)[o.index]),!u)break;return u}},{key:"findNode",value:function(t,e,n){var r,o,i=e||document;return n||"undefined"==typeof i.evaluate?r=n?this.walkToNode(t,i,n):this.walkToNode(t,i):(o=this.stepsToXpath(t),r=i.evaluate(o,i,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),r}},{key:"fixMiss",value:function(t,e,n,r){var o,i,a=this.findNode(t.slice(0,-1),n,r),c=a.childNodes,l=this.normalizedMap(c,u,r),d=t[t.length-1].index;for(var f in l){if(!l.hasOwnProperty(f))return;if(l[f]===d){if(o=c[f],i=o.textContent.length,!(e>i)){a=o.nodeType===s?o.childNodes[0]:o;break}e-=i}}return{container:a,offset:e}}},{key:"toRange",value:function(t,e){var n,r,o,i,a,s,u,c,l=this,d=!!e&&null!=doc.querySelector("."+e);if(n=document.createRange(),l.range?(r=l.start,s=l.path.steps.concat(r.steps),i=this.findNode(s,t,d?e:null),o=l.end,u=l.path.steps.concat(o.steps),a=this.findNode(u,t,d?e:null)):(r=l.path,s=l.path.steps,i=this.findNode(l.path.steps,t,d?e:null)),!i)return console.log("No startContainer found for",this.toString()),null;try{null!=r.terminal.offset?n.setStart(i,r.terminal.offset):n.setStart(i,0)}catch(f){c=this.fixMiss(s,r.terminal.offset,t,d?e:null),n.setStart(c.container,c.offset)}if(a)try{null!=o.terminal.offset?n.setEnd(a,o.terminal.offset):n.setEnd(a,0)}catch(f){c=this.fixMiss(u,l.end.terminal.offset,doc,d?e:null),n.setEnd(c.container,c.offset)}return n}},{key:"isCfiString",value:function(t){return"string"===typeof t&&0===t.indexOf("epubcfi(")&&")"===t[t.length-1]}},{key:"generateChapterComponent",value:function(t,e,n){var r=parseInt(e),o=2*(t+1),i="/"+o+"/";return i+=2*(r+1),n&&(i+="["+n+"]"),i}},{key:"collapse",value:function(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}]),t}();e["a"]=c},8838:function(t,e,n){},"969c":function(t,e,n){"use strict";n("e4f6")},ab8c:function(t,e,n){"use strict";n.d(e,"z",(function(){return r})),n.d(e,"D",(function(){return a})),n.d(e,"n",(function(){return s})),n.d(e,"p",(function(){return u})),n.d(e,"o",(function(){return c})),n.d(e,"u",(function(){return l})),n.d(e,"f",(function(){return d})),n.d(e,"h",(function(){return f})),n.d(e,"r",(function(){return h})),n.d(e,"m",(function(){return p})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return m})),n.d(e,"s",(function(){return v})),n.d(e,"E",(function(){return b})),n.d(e,"l",(function(){return y})),n.d(e,"q",(function(){return x})),n.d(e,"e",(function(){return O})),n.d(e,"A",(function(){return R})),n.d(e,"d",(function(){return T})),n.d(e,"C",(function(){return E})),n.d(e,"t",(function(){return S})),n.d(e,"v",(function(){return N})),n.d(e,"w",(function(){return C})),n.d(e,"x",(function(){return A})),n.d(e,"B",(function(){return _})),n.d(e,"a",(function(){return L})),n.d(e,"g",(function(){return I})),n.d(e,"y",(function(){return B})),n.d(e,"j",(function(){return P})),n.d(e,"i",(function(){return $})),n.d(e,"k",(function(){return F}));n("99af"),n("4de4"),n("4160"),n("c975"),n("fb6a"),n("a434"),n("dca8"),n("e439"),n("7039"),n("d3b7"),n("ac1f"),n("25f0"),n("3ca3"),n("5319"),n("159b"),n("ddb0"),n("2b3d"),n("d4ec"),n("bee2");var r="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),o=1,i="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function a(){var t=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:7&n|8).toString(16)}));return e}function s(t){return!(!t||1!=t.nodeType)}function u(t){return!isNaN(parseFloat(t))&&isFinite(t)}function c(t){var e=parseFloat(t);return!1!==u(t)&&("string"===typeof t&&t.indexOf(".")>-1||Math.floor(e)!==e)}function l(t){var e=["Webkit","webkit","Moz","O","ms"],n=["-webkit-","-webkit-","-moz-","-o-","-ms-"],r=t.toLowerCase(),o=e.length;if("undefined"===typeof document||"undefined"!=typeof document.body.style[r])return t;for(var i=0;i<o;i++)if("undefined"!=typeof document.body.style[n[i]+r])return n[i]+r;return t}function d(t){for(var e=1,n=arguments.length;e<n;e++){var r=arguments[e];for(var o in r)void 0===t[o]&&(t[o]=r[o])}return t}function f(t){var e=[].slice.call(arguments,1);return e.forEach((function(e){e&&Object.getOwnPropertyNames(e).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))})),t}function h(t,e,n,r,o){var i,a=r||0,s=o||e.length,u=parseInt(a+(s-a)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),s-a<=0?u:(i=n(e[u],t),s-a===1?i>=0?u:u+1:0===i?u:-1===i?h(t,e,n,u,s):h(t,e,n,a,u))}function p(t,e,n,r,o){var i,a=r||0,s=o||e.length,u=parseInt(a+(s-a)/2);return n||(n=function(t,e){return t>e?1:t<e?-1:t==e?0:void 0}),s-a<=0?-1:(i=n(e[u],t),s-a===1?0===i?u:-1:0===i?u:-1===i?p(t,e,n,u,s):p(t,e,n,a,u))}function g(t){var e=window.getComputedStyle(t),n=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],o=0,i=0;return n.forEach((function(t){o+=parseFloat(e[t])||0})),r.forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:o}}function m(t){var e=window.getComputedStyle(t),n=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],r=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],o=0,i=0;return n.forEach((function(t){o+=parseFloat(e[t])||0})),r.forEach((function(t){i+=parseFloat(e[t])||0})),{height:i,width:o}}function v(t){var e,n=t.ownerDocument;if(t.nodeType==Node.TEXT_NODE){var r=n.createRange();r.selectNodeContents(t),e=r.getBoundingClientRect()}else e=t.getBoundingClientRect();return e}function b(){var t=window.innerWidth,e=window.innerHeight;return{top:0,left:0,right:t,bottom:e,width:t,height:e}}function w(t,e){for(var n,r=t.parentNode,o=r.childNodes,i=-1,a=0;a<o.length;a++)if(n=o[a],n.nodeType===e&&i++,n==t)break;return i}function y(t){return w(t,o)}function x(t){return["xml","opf","ncx"].indexOf(t)>-1}function k(t,e){return new Blob([t],{type:e})}function O(t,e){var n,r=k(t,e);return n=i.createObjectURL(r),n}function R(t){return i.revokeObjectURL(t)}function T(t,e){var n,r;if("string"===typeof t)return n=btoa(encodeURIComponent(t)),r="data:"+e+";base64,"+n,r}function E(t){return Object.prototype.toString.call(t).slice(8,-1)}function S(t,e,r){var o,i;return i="undefined"===typeof DOMParser||r?n("1456").DOMParser:DOMParser,65279===t.charCodeAt(0)&&(t=t.slice(1)),o=(new i).parseFromString(t,e),o}function N(t,e){var n;if(!t)throw new Error("No Element Provided");return"undefined"!=typeof t.querySelector?t.querySelector(e):(n=t.getElementsByTagName(e),n.length?n[0]:void 0)}function C(t,e){return"undefined"!=typeof t.querySelector?t.querySelectorAll(e):t.getElementsByTagName(e)}function A(t,e,n){var r,o;if("undefined"!=typeof t.querySelector){for(var i in e+="[",n)e+=i+"~='"+n[i]+"'";return e+="]",t.querySelector(e)}if(r=t.getElementsByTagName(e),o=Array.prototype.slice.call(r,0).filter((function(t){for(var e in n)if(t.getAttribute(e)===n[e])return!0;return!1})),o)return o[0]}function _(t,e){var n=t.ownerDocument||t;"undefined"!==typeof n.createTreeWalker?j(t,e,NodeFilter.SHOW_TEXT):D(t,(function(t){t&&3===t.nodeType&&e(t)}),!0)}function j(t,e,n){var r,o=document.createTreeWalker(t,n,null,!1);while(r=o.nextNode())e(r)}function D(t,e){if(e(t))return!0;if(t=t.firstChild,t)do{var n=D(t,e);if(n)return!0;t=t.nextSibling}while(t)}function L(t){return new Promise((function(e,n){var r=new FileReader;r.readAsDataURL(t),r.onloadend=function(){e(r.result)}}))}function I(){var t=this;this.resolve=null,this.reject=null,this.id=a(),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n})),Object.freeze(this)}function B(t,e,n){var r;if("undefined"!=typeof t.querySelector&&(r=t.querySelector("".concat(e,'[*|type="').concat(n,'"]'))),r&&0!==r.length)return r;r=C(t,e);for(var o=0;o<r.length;o++)if(r[o].getAttributeNS("http://www.idpf.org/2007/ops","type")===n||r[o].getAttribute("epub:type")===n)return r[o]}function P(t){for(var e=[],n=t.childNodes,r=0;r<n.length;r++){var o=n[r];1===o.nodeType&&e.push(o)}return e}function $(t,e,n){for(var r=[],o=t.childNodes,i=0;i<o.length;i++){var a=o[i];if(1===a.nodeType&&a.nodeName.toLowerCase()===e){if(n)return a;r.push(a)}}if(!n)return r}function F(t,e){var n;if(null!==t&&""!==e){n=t.parentNode;while(1===n.nodeType){if(n.tagName.toLowerCase()===e)return n;n=n.parentNode}}}},e4f6:function(t,e,n){},e950:function(t,e,n){"use strict";n("3b1d")},f7e7:function(t,e,n){"use strict";n("8838")}});
//# sourceMappingURL=app.85c54e10.js.map